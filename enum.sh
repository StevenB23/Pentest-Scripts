#!/bin/bash
# CHANGE THE IP and COMMENT OUT WHAT YOU DON'T WANT TO RUN
ip=$1 # dollar sign 1 for command line argument 1
if [ $# -eq 0 ]
	then
		 echo "No arguments supplied"
		 exit
fi
#ALL NMAP SCANS HAVE BEEN MOVED TO MY targeted-nmap.py SCRIPT
#nmap -oN ftp.nmap --script "ftp-* and not ftp-brute*" --script-args= -d -T2 -Pn -v -p 21 $ip &
nmap -oN ssh.nmap -sV --script "ssh* and not ssh-brute*" --script-args= -d  -T2 -Pn -v -p 22 $ip &
#nmap -oN smtp.nmap --script "smtp-commands,smtp-enum-users,smtp-ntlm-info,smtp-open-relay,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764" --script-args= -d -v  -sV --version-intensity 9 -Pn -T2 -p 2525 $ip & 
#nmap -oN http.nmap --script "http* and not http-brute* and not http-slowloris* and not http-rfi-spider* and not http-sql-injection* and not http-form* and not http-iis*" --script-args= -sV  -Pn -T3 -vv -p 8080 $ip &
#nmap -oN http.nmap --script "http* and not http-brute* and not http-slowloris* and not http-rfi-spider* and not http-sql-injection* and not http-form**" --script-args= -d -T2 -Pn -sV -T2 -vv -p 8009 $ip
#nmap -oN smb.nmap --script "smb-* and not smb-brute* and not smb-flood" --script-args= -d -Pn  -sV -T0 -v -p 139,445 $ip &
#nmap -oN smb.nmap --script "smb-* and not smb-brute* and not smb-flood" --script-args=smbusername='robert',smbdomain='thinc.local',smbpassword='!Qwerty^' -d -Pn  -sV -T2 -v -p 139,445 $ip &
#nmap -oN https.nmap --script ssl-enum-ciphers,ssl-ccs-injection,ssl-cert,ssl-date,ssl-dh-params,ssl-heartbleed,ssl-known-key,ssl-poodle,sslv2,sslv2-drown --script-args= -d -v -p 443 $ip &
#nmap -oN imap.nmap --script "imap-capabilities,imap-ntlm-info,imap-brute" --script-args= -d -T2  -Pn -v -p 143 $ip &
#nmap -oN mysql.nmap --script "mysql-empty-password,mysql-enum,mysql-info,mysql-users,mysql-variables,mysql-vuln-cve2012-2122" --script-args=query="SELECT host, user FROM mysql.user" -d -sV  -Pn -T2 -v -p 3306 $ip &
#nmap -oN rdp.nmap --script "rdp-enum-encryption,rdp-vuln-ms12-020" --script-args= -d -sV  -T2 -Pn -v -p 3389 $ip &
# nmap -oN vnc.nmap -sV --version-intensity 9 --script "*vnc* and not *brute*" --script-args= -d -Pn -v  -T3 -p 5800,5900 $ip &
#nmap -oN dnsscans --script "dns* and not dns-blacklist*" --script-args=dns-nsec-enum.domains=thinc.local,dns-nsec3-enum.domains=thinc.local,domain=thinc -d -sV -Pn -vv  -p 53,5353 $ip & 
# nmap -oN ldap.nmap -sV --version-intensity 9  -Pn -T2 -p 389 --script "ldap* and not ldap-brute" --script-args= $ip &
#nmap -oN snmp.nmap -sV -Pn -sU -T2 --script=snmp-brute -p 161 $ip &
#nmap -oN telnet.nmap --script "telnet* and not telnet-brute" --script-args= -d -Pn -v -T2 -p 23 $ip
#nmap -oN oracle.nmap --script "oracle* and not oracle-brute*" --script-args= -d -Pn -v -T2 -p 1038,1521,1748,1754,1808,1809,2030 $ip
#nmap -sV -T2 --script=nfs-showmount -p 111 $ip

# TARGETED TESTS

# HTTP
#davtest -url http://$ip/ >> davtest.txt 2>>davtest.txt &
#davtest -url https://$ip/ >> davtest.txt 2>>davtest.txt &
nikto -o nikto.txt -h $ip -p 8080   #-id loki:godofmischiefisloki
#nikto -o nikto.txt -h $ip -p 443 #-id loki:godofmischiefisloki
#gobuster_unix.py http://$ip:80
#gobuster_unix.py https://$ip:443
#gobuster_iis.py http://$ip:3339
#gobuster_iis.py http://$ip:7778
#gobuster_iis.py http://$ip:8080
#gobuster_iis.py http://$ip
whatweb -v -a 4 http://$ip:8080 >> whatweb.txt &
#wpscan --url http://$ip --enumerate u,ap,tt,t -o ./wpscan.txt

# SMTP
#smtp-user-enum -p 25 -M VRFY -U /root/oscp/lab-net2019/usernames.txt -t $ip >> smtp-enum.txt &

# SNMP
#snmp-check -w $ip -c public > snmp-check.txt &

#SMB
#echo -e "\n==SMBMAP GUEST USER TEST==\n" > smbmap.txt
#smbmap -u guest -p "" -H $ip >> smbmap.txt
#smbmap -d THINC -u robert -p '!Qwerty^' -H $ip >> smbmap.txt
#echo -e "\n==SMBMAP ANONYMOUS USER TEST==\n" >> smbmap.txt
#smbmap -H $ip -r >> smbmap.txt

# SMB on Nix
#enum4linux $ip >> enum4linux.txt
#
# EXPLOITS TO TRY
# For SSH
#proxychains /root/anaconda3/envs/ipykernel_py2/bin/python /root/exploits/ssh/CVE-2018-15473.py --userList /root/oscp/lab-net2019/usernames.txt $ip --port 22 --outputFile sshenumeration.txt --outputFormat list 2>/dev/null

# BRUTE FORCE ATTEMPTS
#patator ssh_login host=$ip port=22 --threads=10 user=root password=FILE0 0=/root/oscp/lab-net2019/passwords.txt -x ignore:mesg='Authentication failed.' -l ssh_brute
#proxychains patator ssh_login host=$ip port=22 --threads=10 user=root password=FILE0 0=/root/oscp/lab-net2019/passwords.txt -x ignore:mesg='Authentication failed.' -l ssh_brute
